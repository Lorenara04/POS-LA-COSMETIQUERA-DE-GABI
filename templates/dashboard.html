{% extends "base.html" %}
{% block title %}Dashboard - POS Cosmetiquer√≠a{% endblock %}

{% block content %}

<div class="dashboard-container">

    <!-- FONDO DE PART√çCULAS -->
    <div class="fondo-particulas"></div>

    <!-- TARJETA DE BIENVENIDA -->
    <div class="welcome-card">
        <h2>¬°Bienvenido/a, {{ current_user.username }}!</h2>
        <p>Rol: <span>{{ current_user.rol | capitalize }}</span></p>
    </div>

    <!-- BOTONES PRINCIPALES -->
    <div class="dashboard-buttons">
        
        {% if current_user.rol.lower() in ['administradora', 'administrador'] %}
        <a href="{{ url_for('reportes') }}" class="btn-dashboard reports">
            <i class="bi bi-bar-chart-fill"></i> Ver Informes
        </a>

        <a href="{{ url_for('gestion_ventas') }}" class="btn-dashboard manage-sales">
            <i class="bi bi-collection-fill"></i> Gesti√≥n Ventas
        </a>
        {% endif %}

        <a href="{{ url_for('nueva_venta') }}" class="btn-dashboard new-sale">
            <i class="bi bi-cart-check-fill"></i> Nueva Venta
        </a>

        {% if current_user.rol.lower() == 'vendedora' %}
        <a href="{{ url_for('reportes') }}" class="btn-dashboard" 
           style="background: linear-gradient(135deg, #E040FB, #ff43d0);">
            <i class="bi bi-cash-stack"></i> Cierre de Caja
        </a>
        {% endif %}
    </div>

   
    <!-- TARJETAS ESTAD√çSTICAS -->
    <div class="stats-section">

        <div class="stat-card sales-today">
            <h3>Ventas de Hoy</h3>
            <p class="stat-value">${{ ventas_hoy | default(0.00) | format_number }}</p> 
        </div>

        <div class="stat-card total-inventory"> 
            <h3>Total de Inventario</h3>
            <p class="stat-value">
                {{ total_inventario | default(0) | format_number }} 
                <span style="font-size: 0.5em; display: block;">unidades</span>
            </p>
        </div>
        
        <div class="stat-card new-clients">
            <h3>Clientes Nuevos</h3>
            <p class="stat-value">{{ clientes_nuevos_mes | default(0) }}</p>
        </div>

        {% if current_user.rol.lower() == 'administrador' %}
        <div class="stat-card inventory-value">
            <h3>Valor Interno Total</h3>
            <p class="stat-value">${{ valor_interno_total | format_number }}</p>
        </div>

        <div class="stat-card inventory-value2">
            <h3>Valor Total a la Venta</h3>
            <p class="stat-value">${{ valor_venta_total | format_number }}</p>
        </div>
        {% endif %}

    </div>
</div>


<!-- ===================== ESTILOS ===================== -->
<style>

/* Fondo general */
.dashboard-container {
    position: relative;
    z-index: 1;
    min-height: 100vh;
    padding: 40px 20px;
    background: #fff0f7;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 45px;
}

/* Fondo part√≠culas */
.fondo-particulas {
    position: fixed;
    inset: 0;
    z-index: 0;
    overflow: hidden;
    pointer-events: none;
}

.fondo-particulas span {
    position: absolute;
    animation: flotar 18s linear infinite;
    opacity: 0.2;
    user-select: none;
}

@keyframes flotar {
    0% { transform: translateY(0) rotate(0deg); }
    50% { transform: translateY(-120px) rotate(180deg); }
    100% { transform: translateY(0) rotate(360deg); }
}

/* Bienvenida */
.welcome-card {
    background: linear-gradient(135deg, #ffb6e1, #ffb6e1, #ff1493);
    color: #fff;
    padding: 25px 35px;
    border-radius: 25px;
    text-align: center;
    box-shadow: 0 15px 35px rgba(0,0,0,0.2);
    max-width: 600px;
    width: 100%;
    animation: gradientMove 10s ease infinite;
}

@keyframes gradientMove {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

/* Botones */
.dashboard-buttons {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 22px;
    max-width: 780px;
    width: 100%;
}

.btn-dashboard {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 18px 32px;
    border-radius: 25px;
    font-weight: 700;
    text-decoration: none;
    color: #fff;
    min-width: 250px;
    background: linear-gradient(135deg, #d63384, #e754a3);
    transition: .3s ease;
    box-shadow: 0 6px 18px rgba(0,0,0,0.2);
}

.btn-dashboard:hover {
    transform: translateY(-6px) scale(1.05);
}

/* Stats */
.stats-section {
    display: flex;
    flex-wrap: wrap;
    gap: 25px;
    justify-content: center;
    max-width: 1000px;
}

.stat-card {
    background: #fff;
    padding: 20px;
    border-radius: 22px;
    min-width: 210px;
    flex: 1;
    text-align: center;
    box-shadow: 0 5px 18px rgba(0,0,0,0.12);
    transition: .3s ease;
}

.stat-card:hover {
    transform: translateY(-5px);
}

.stat-card h3 {
    font-size: 1.05rem;
    color: #d63384;
    font-weight: 700;
}

.stat-value {
    margin-top: 6px;
    font-size: 2rem;
    font-weight: 900;
}

.inventory-value {
    border-bottom: 5px solid #6a1b9a;
}

.inventory-value2 {
    border-bottom: 5px solid #c71585;
}

/* Responsive */
@media (max-width: 780px) {
    .dashboard-buttons { flex-direction: column; }
    .btn-dashboard { width: 100%; }
}

</style>


<!-- ===================== SCRIPT PART√çCULAS ===================== -->
<script>
const fondo = document.querySelector('.fondo-particulas');
const emojis = ['üíÑ','üíÖ','‚ú®','üíñ','üéÄ','ü¶ã','üå∏','‚≠ê'];
const cantidad = 35;

for (let i = 0; i < cantidad; i++) {
    const span = document.createElement('span');
    span.innerText = emojis[Math.floor(Math.random() * emojis.length)];
    span.style.top = Math.random() * 100 + 'vh';
    span.style.left = Math.random() * 100 + 'vw';
    span.style.animationDuration = 12 + Math.random() * 15 + 's';
    span.style.fontSize = 20 + Math.random() * 38 + 'px';
    fondo.appendChild(span);
}
</script>

{% endblock %}
